## Дополненные функциональные требования, языки, контексты и сущности

### Функциональные требования:
1. Гость должен иметь возможность зарегистрироваться, введя логин и пароль.
2. Пароль должен удовлетворять требованиям: “минимальная длина логина - 5 символов, логин может содержать только буквы латинского алфавита и цифры и должен быть уникальным”
3. Зарегистрированный пользователь должен иметь возможность авторизоваться.
4. При неуспешной авторизации должен иметь возможность “попробовать зайти еще раз с другими данными”
5. Авторизованный пользователь должен иметь возможность создать проект с обязательным и “уникальным” указанным названием и “опционально идентификаторами участников проекта”.
6. Если название проекта не уникальное - авторизованный пользователь должен увидеть ошибку и вернуться на форму заполнения с введенными ранее данными
7. Название проекта должно удовлетворять требованиям: Начинается с большой буквы, длина не более 128 символов, в названии допускаются буквы латинского алфавита, цифры и символы [] - _ , . {} 
8. После создания проекта авторизованный пользователь должен стать участником проекта
9. Авторизованный пользователь должен иметь возможность добавлять участников проекта, в котором он участвует
10. Авторизованный пользователь должен иметь возможность создавать задачи в рамках проекта, в котором он участвует, указывая обязательное название и опциональные данные.
11. Название задачи должно удовлетворять требованиям: Начинается с большой буквы, длина не более 128 символов, в названии допускаются буквы латинского алфавита, цифры и символы [] - _ , . {} 
12. Опциональные данные: ID исполнителя(только одного), оценку в днях, приоритет(низкий, средний, высокий)
13. Если название задачи не уникальное - авторизованный пользователь должен увидеть ошибку и вернуться на форму заполнения с введенными ранее данными
14. После создания задачи участник проекта, создавший задачу, должен назначаться ее создателем, задача должна помечаться как новая
15. Авторизованный пользователь должен иметь возможность указывать исполнителя(только одного) задачи в рамках проекта, в котором он участвует
16. Авторизованный пользователь должен иметь возможность менять любые поля задачи в рамках проекта, в котором он участвует
17. Авторизованный пользователь должен иметь возможность помечать задачу как выполненную в проектах, в которых он участвует
18. Авторизованный пользователь должен иметь возможность удалять задачу в проектах, в которых он участвует
19. Авторизованный пользователь должен иметь возможность возвращать задачу в работу в проектах, в которых он участвует.
20. Авторизованный пользователь должен иметь возможность удалять любую задачу в проектах, в которых он участвует.

**21. Авторизованные пользователи, которые являются участниками проекта, могут создавать статусы в проекте с уникальным названием и цветом отображения. \
22. У каждого проекта есть статусы \
    - статус по умолчанию у проекта — "CREATED". \
23. Авторизованные пользователи, которые являются участниками проекта, могут присваивать и изменять статусы задач. \
24. Удаление статусов в проекте возможно, только если ни одна задача проекта не имеет данного статуса. \
25. Авторизованные пользователи, которые являются участниками проекта, могут изменять порядок отображения статусов. \
26.На пользовательском интерфейсе (UI) статусы задач отображаются в формате "доски" (канбан), где колонки — это статусы, а задачи в соответствующих колонках.**

### Ubiquitous language:

*1. Проект (Project)* - это логическая сущность, которая объединяет в себе некоторое количество участников проекта (они являются пользователями) и задачи. 
  Атрибуты:
- Имя (Name): Уникальное имя проекта, не более 128 символов.
- Создатель (Creator): Пользователь, создавший проект. 
- Участники (Participants): Список пользователей, участвующих в проекте.
- Дата создания (Creation Date):Дата создания проекта. 
- Дата обновления (Update Date):Дата последнего изменения проекта. 
 Действия:
- Создать проект: Требуется уникальное имя проекта, идентификатор создателя (никнейм), и опционально идентификаторы участников. 
- Изменить название: Доступно только создателю проекта.
 - Добавить участника: Любой участник проекта может добавить другого участника, указывая его идентификатор.
- Удалить проект: Доступно только создателю проекта.

  Состояния:
- Проект не имеет состояний. 
- Существует история изменений проекта.

*2. Задача (Task)* - это задача в контексте проекта, которая имеет определенное имя и может быть назначена на исполнителя.
  Атрибуты:
- Имя (Name): Уникальное имя задачи в контексте проекта, не более 128 символов.
- Исполнитель (Executor): Пользователь, назначенный исполнителем задачи. Может быть null. 
- Создатель (Creator): Пользователь, создавший задачу. 
- Ожидаемая оценка (Estimated Effort): Ожидаемое время выполнения задачи в днях.
- Приоритет (Priority): Приоритет задачи (низкий, средний, высокий). 
- Статус (Status): Статус задачи (новая, в работе, ревью, завершена).
- Дата создания (Creation Date): Дата создания задачи. 
- Дата обновления (Update Date): Дата последнего изменения задачи. 
  Действия:
- Создать задачу: Требуется уникальное название задачи в проекте, опционально - идентификатор исполнителя (только 1), оценка в днях и приоритет.
- Изменить задачу: Любой участник проекта может изменить любое поле задачи, включая название. 
- Удалить задачу: Любой участник проекта может удалить задачу.
- Назначить исполнителя: Любой участник проекта может назначить другого участника проекта исполнителем задачи.
  Состояния:
- Новая (New): Задача только что создана. 
- В работе (In progress): Задача выполняется исполнителем.
- Ревью (Review): Задача завершена и ожидает проверки. 
- Завершена (Completed): Задача завершена и проверена. 
- Существует история изменений задачи.

*3. Пользователь (User)* - это пользователь системы.
  Атрибуты:
- Логин (Login): Уникальный логин пользователя, не менее 5 символов, содержащий только буквы латинского алфавита и цифры. 
- Пароль (Password): Пароль пользователя, не менее 8 символов, без ограничений на символы. 
- Никнейм (Nickname): Никнейм пользователя (используется для идентификации в проекте).
  Действия:
- Регистрация: Требуется логин и пароль.
- Авторизация: Требуется логин и пароль. 
  Состояния:
- Гость (Guest): Пользователь не зарегистрирован и не авторизован.
- Авторизованный (Authorized): Пользователь зарегистрирован и авторизован.
 
*4. История изменений (History)* - это регистрация изменений в системе (проектов и задач).
  Атрибуты:
- Измененная сущность (Entity): Тип сущности, которая была изменена (проект или задача).
- Идентификатор сущности (Entity ID): Уникальный идентификатор измененной сущности.
- Пользователь (User): Пользователь, который внес изменения. 
- Дата изменения (Update Date): Дата и время изменения. 
Состояния:
- Состояние "до" (Before State): Состояние сущности до изменения.
- Состояние "после" (After State): Состояние сущности после изменения. 

**5. Статус (Status) - Определяет стадию выполнения задачи. \
   Атрибуты: \
     - Название (Name): Имя статуса, уникальное в рамках проекта. \
     - Цвет (Color): Цвет для отображения на UI. \
     - Порядок (Order): Позиция статуса на доске (опционально). \
   Действия: \
     - Создать статус: Указание имени и цвета. \
     - Изменить статус: Участники могут изменить имя, цвет или порядок. \
     - Удалить статус: Только если к статусу не привязана ни одна задача.
  Возможные состояния: \
     - Активный (Active) - задача активна, в работе. \
     - По умолчанию (Default) - специальное состояние статуса «CREATED», который устанавливается как начальный статус для всех новых задач в проекте. \
     - Закрыто (Closed) - закрытые задачи.**

### Bounded contexts

_1. User Management (Управление пользователями)_
Термины: Пользователь (User), Гость (Guest), Авторизованный (Authorized), Логин (Login), Пароль (Password), Никнейм (Nickname), Регистрация (Registration), Авторизация (Authorization), История изменений (History).

*2. Project Management (Управление проектами)*
Термины: Проект (Project), Название проекта (Project Name), Создатель проекта (Project Creator), Участники проекта (Project Participants), Добавить участника (Add Participant), Удалить проект (Delete Project), Изменить название проекта (Rename Project), История изменений проекта (Project History). 

*3. Task Management (Управление задачами)*
Термины: Задача (Task), Название задачи (Task Name), Исполнитель (Executor), Создатель (Creator), Ожидаемая оценка (Estimated Effort), Приоритет (Priority), Статус задачи (Task Status), Новая (New), В работе (In progress), Ревью (Review), Завершена (Completed), Добавить задачу (Add Task), Изменить задачу (Edit Task), Удалить задачу (Delete Task), История изменений задачи (Task History).

*4. Search (Поиск)*
Термины: Поиск по никнейму (Nickname Search), Поиск по названию проекта (Project Name Search), Поиск по названию задачи (Task Name Search), Результат поиска (Search Result).

*5.History (История)*
Термины: История (History), Измененная сущность (Entity), Идентификатор сущности (Entity ID), Пользователь (User), Дата изменения (Update Date), Состояние "до" (Before State), Состояние "после" (After State).

**6. Status Management (Управление статусами) \
Термины: Статус (Status), Название (Name), Цвет (Color), Порядок (Order), Создать статус (Create Status), Изменить статус (Change Status), Удалить статус (Delete Status).**

### Entities

#### 1. Пользователь (User)  
   - Обоснование: Пользователь — это центральная сущность в любом приложении с управляемым доступом. Пользователи создают проекты и задачи, а также взаимодействуют друг с другом в системе. 
   - Атрибуты: Логин (Login), Пароль (Password), Никнейм (Nickname). 
   - Ограниченный контекст: User Management.

#### 2. Проект (Project)  
   - Обоснование: Проект объединяет связанные задачи и участников, предоставляя структуру и контекст для управления задачами. Это основная логическая единица, с которой взаимодействуют пользователи.
   - Атрибуты: Имя (Name), Создатель (Creator), Участники (Participants), Дата создания (Creation Date), Дата обновления (Update Date).
   - Ограниченный контекст: Project Management.

#### 3. Задача (Task)  
   - Обоснование: Задачи составляют суть операционной части проекта и требуют управления и отслеживания их выполнения. Они имеют различные статусы, которые являются важными для их жизненного цикла.
   - Атрибуты: Имя (Name), Исполнитель (Executor), Создатель (Creator), Ожидаемая оценка (Estimated Effort), Приоритет (Priority), Статус (Status), Дата создания (Creation Date), Дата обновления (Update Date). **Добавление атрибута "Статус" (Status), чтобы отразить текущий статус задачи в проекте.**
   - Ограниченный контекст: Task Management.

#### 4. История изменений (History)  
   - Обоснование: История изменений позволяет отслеживать, как и когда изменялись проекты и задачи, что важно для аудита и анализа процессов.
   - Атрибуты: Измененная сущность (Entity), Идентификатор сущности (Entity ID), Пользователь (User), Дата изменения (Update Date), Состояние "до" (Before State), Состояние "после" (After State).
   - Ограниченный контекст: History.

**5. Статус (Status)** \
   **- Обоснование: Статус добавляет важную информацию о текущем этапе выполнения задачи и является ключевой частью логики проекта.** \
   **- Атрибуты: Название (Name): Название статуса, уникальное в проекте.  Цвет (Color): Цвет отображения на UI.  Порядок (Order): Позиция на доске.** \
   **- Ограниченный контекст: Status Management.**


## Анализ Функциональных Требований и Агрегатов

#### 1. Пользовательские Операции
- Регистрация и Авторизация
  - Сущности: Пользователь (User)
  - Ограниченный контекст: User Management
  - Изменения: Создание новой сущности "Пользователь" при регистрации. Обновление статуса пользователя при авторизации.
  - Инварианты: Уникальность логина. Это требует строгой транзакционной согласованности.

#### 2. Управление Проектами
- Создание Проекта
  - Сущности: Проект (Project), Пользователь (User)
  - Ограниченный контекст: Project Management
  - Изменения: Создание новой сущности "Проект". Не требуется изменений сущности "Пользователь", но она участвует как создатель.
  - Инварианты: Уникальность имени проекта. Создатель должен быть авторизован. Требуется строгая согласованность.

- Добавление и Управление Участниками
  - Сущности: Проект (Project), Пользователь (User)
  - Ограниченный контекст: Project Management
  - Изменения: Обновление листа участников в сущности "Проект".
  - Инварианты: Только авторизованные пользователи могут быть добавлены в проект.

#### 3. Управление Задачами
- Создание и Управление Задачами
  - Сущности: Задача (Task), Проект (Project)
  - Ограниченный контекст: Task Management
  - Изменения: Создание и обновление сущности "Задача". Ссылка на проект, в который она включена.
  - Инварианты: Уникальное имя задачи в рамках проекта. Поддерживает транзакционность при создании и обновлении.

#### 4. Управление Статусами
- Создание и Управление Статусами
  - Сущности: Статус (Status), Проект (Project)
  - Ограниченный контекст: Status Management
  - Изменения: Создание и удаление статусов в проекте. Обновление задач для соответствия новым статусам.
  - Инварианты: Уникальность статуса в проекте. Удаление возможно только если нет связанных задач. 
  - Согласованность: Требуется строгая согласованность для удаления статусов.

#### 5. Управление Историей Изменений
- Логирование Изменений
  - Сущности: История изменений (History), Проект (Project), Задача (Task)
  - Ограниченный контекст: History
  - Изменения: Добавление записей в историю при изменениях задач и проектов.
  - Инварианты: Точность записей в истории изменений не требует строгой транзакционной согласованности.

### Выделение Агрегатов

На основе анализа, мы можем выделить следующие агрегаты:

1. User Aggregate
   - Состав: Пользователь (User)
   - Ограниченный контекст: User Management
   - Комментарий: Обеспечивает уникальность и безопасность операций с пользователями.

2. Project Aggregate
   - Состав: Проект (Project), Статусы (Status)
   - Ограниченный контекст: Project Management, Status Management
   - Комментарий: Включает в себя логику управления проектами и статусами, объединяя их в единый контекст.

3. Task Aggregate
   - Состав: Задача (Task)
   - Ограниченный контекст: Task Management
   - Комментарий: Фокусируется на управлении задачами и их жизненным циклом.

4. History Aggregate
   - Состав: История изменений (History)
   - Ограниченный контекст: History
   - Комментарий: Отдельный контекст, который не требует строгой согласованности, но важен для аудита.
